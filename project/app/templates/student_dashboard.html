{% extends 'base.html' %}

{% block content %}
    <h2>欢迎 {{ student.name }}（学生）</h2>
    <p>权限等级：{{ student.access_level }} ｜ 下载配额：{{ student.thesis_quota }} 单位</p>

  <!-- 搜索论文 -->
  <section>
    <h3>搜索论文</h3>
    <form method="post" action="{{ url_for('student.search_thesis') }}">
      <input type="text" name="keywords" placeholder="请输入关键词" required>
      <button type="submit">搜索</button>
    </form>
  </section>

  <!-- 搜索结果显示 -->
  {% if theses %}
    <section>
      <h3>搜索结果</h3>
      <ul>
        {% for thesis in theses %}
        <li>
            <strong>{{ thesis.title }}</strong><br>
            {{ thesis.abstract }}<br>
            <em>权限要求：Scope={{ thesis.access_scope }} ｜ Type={{ thesis.access_type }} ｜ {% if thesis.is_free %}免费{% else %}需{{ thesis.price }}单位{% endif %}</em><br>
          
            <form method="post" action="{{ url_for('student.purchase_thesis') }}">
              <input type="hidden" name="title" value="{{ thesis.title }}">
              <button type="submit">购买并下载</button>
            </form>
          </li>          
        {% endfor %}
      </ul>
    </section>
  {% endif %}

{% endblock %}
